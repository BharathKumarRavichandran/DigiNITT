<%include partials/studentHeader%>
<!--<div> <%=JSON.stringify(data.activeRequests[0])%></div>-->


<div class="animated fadeIn">
    <div class = "row text-center">
        <div class="container">
                <div class="card-body">
                  <div class="btn-group text-center">
                    <a id="btnNewForm" class="btn btn-info btn-block btn-md" href="/workflow/list">Apply for a form</a>
                </div>
              </div>
        </div>
    </div>
    <!-- Widgets  -->
<% if(data.activeRequests.length>0){ %>
    <h3>Ongoing Requests</h3> <br />
</br>
<br>
<div class="row text-center">
        <div class="col-lg-12 col-md-12">
            <div class="">
                  <div class="card-body">
                    <div class="row text-center">
                      <%for(let i=0;i<data.activeRequests.length;i++){%>
                        <div class="col-lg-4 ">
                            <div class="card">
                                <div class="card-header">
                                    <div style="display: flex; justify-content: space-between;">
                                        <b class="top-pad">
                                            <h3><%=data.activeRequests[i].workflowId.name%></h3>
                                        </b>
                                        <!--<div class="circle">712</div>-->

                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-lg-5" style="padding-left: 10px;">
                                             Approved by:
                                        </div>
                                        <div class="col-lg-7 approver" style="text-align: left;">
                                            <%for(let j=0;j<data.activeRequests[i].approvedBy.length;j++){%>
                                                <%if(data.activeRequests[i].approvedBy[j].approverId){%>
                                                    <span class="badge badge-primary" style="background-color: #24bb2b;">
                                                       <%=data.activeRequests[i].approvedBy[j].approverId.username%>
                                                    </span>
                                                <%}%>
                                              <%}%>
                                        </div>
                                    </div>
                                    <br />
                                    <div class="row text-center">
                                      <ul class="list-group list-group-flush">
                                          <li class="list-group-item">
                                              <i class="fa fa-calendar"></i>  Approved On :  <span class="badge badge-warning pull-center r-activity">24/02/2020</span>
                                          </li>
                                        </ul>
                                      </div>
                                      <div class="row text-center">
                                        <ul class="list-group list-group-flush">
                                          <li class="list-group-item">
                                              <i class="fa fa-calendar"></i>  Applied On :  <span class="badge badge-info pull-center r-activity">24/02/2020</span>
                                          </li>
                                      </ul>
                                    </div>
                                </div>
                                <div class="row text-center">
                                        <div class="col-lg-2"></div>
                                        <div class="col-lg-8"><a href="/request/view?requestId=<%=data.activeRequests[i]._id%>"><button class="btn remind btn-success" id="remind">View Status</button></div>
                                        <div class="col-lg-2"></div>
                                      </div>
                                      <div style="height: 30px"></div>
                            </div>
                        </div>
                        <%}%>
                    </div>
                </div>
            </div>
        </div>
    </div>
<% } %>

<% if(data.completedRequests.length>0){ %>
    <!-- Widgets  -->
    <h3>Completed Requests</h3> <br />
  </br>
  <br>
  <div class="row text-center">
        <div class="col-lg-12 col-md-12">
            <div class="">
                  <div class="card-body">
                    <div class="row text-center">
                      <%for(let i=0;i<data.completedRequests.length;i++){%>
                        <div class="col-lg-4 ">
                            <div class="card">
                                <div class="card-header">
                                    <div style="display: flex; justify-content: space-between;">
                                        <b class="top-pad">
                                            <h3><%=data.completedRequests[i].workflowId.name%></h3>
                                        </b>
                                        <!--<div class="circle">712</div>-->

                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="row text-center">
                                        <div class="col-lg-5" style="padding-left: 10px;">
                                             Approved by: 
                                        </div>
                                        <div class="col-lg-7 approver">
                                          <%for(let j=0;j<data.completedRequests[i].approvedBy.length;j++){%>
                                              <%if(data.completedRequests[i].approvedBy[j].approverId){%>
                                                  <span class="badge badge-primary" style="background-color: #24bb2b;">
                                                     <%=data.completedRequests[i].approvedBy[j].approverId.username%>
                                                  </span>
                                              <%}%>
                                            <%}%>
                                        </div>
                                    </div>
                                    <br />
                                    <div class="row text-center">
                                      <ul class="list-group list-group-flush">
                                          <li class="list-group-item">
                                              <a href="#"> <i class="fa fa-calendar"></i>  Approved On :  <span class="badge badge-warning pull-center r-activity">24/02/2020</span></a>
                                          </li>
                                        </ul>
                                      </div>
                                      <div class="row text-center">
                                        <ul class="list-group list-group-flush">
                                          <li class="list-group-item">
                                              <a href="#"> <i class="fa fa-calendar"></i>  Applied On :  <span class="badge badge-info pull-center r-activity">24/02/2020</span></a>
                                          </li>
                                      </ul>
                                    </div>
                                </div>
                                <div class="row text-center">
                                    <div class="col-lg-6"><a href="/request/certificate/view?requestId=<%=data.completedRequests[i]._id%>" class="btn btn-info" style="margin: 30px" >Download form with details</a></div>
                                </div>
                                      <div style="height: 30px"></div>
                            </div>
                        </div>
                        <%}%>
                    </div>
                </div>
            </div>
        </div>
    </div>
<% } %>

<% if(data.rejectedRequests.length>0){ %>
    <!-- Widgets  -->
    <h3>Rejected Requests</h3> <br />
</br>
<br>
<div class="row text-center">
        <div class="col-lg-12 col-md-12">
            <div class="">
                  <div class="card-body">
                    <div class="row text-center">
                      <%for(let i=0;i<data.rejectedRequests.length;i++){%>
                        <div class="col-lg-4 ">
                            <div class="card">
                                <div class="card-header">
                                    <div style="display: flex; justify-content: space-between;">
                                        <b class="top-pad">
                                            <h3><%=data.rejectedRequests[i].workflowId.name%></h3>
                                        </b>
                                        <!--<div class="circle">712</div>-->

                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="row text-center">
                                        <div class="col-lg-5" style="padding-left: 10px;">
                                             Approved by: 
                                        </div>
                                        <div class="col-lg-7 approver">
                                            <%for(let j=0;j<data.rejectedRequests[i].approvedBy.length;j++){%>
                                                <%if(data.rejectedRequests[i].approvedBy[j].approverId){%>
                                                    <span class="badge badge-primary" style="background-color: #24bb2b;">
                                                       <%=data.rejectedRequests[i].approvedBy[j].approverId.username%>
                                                    </span>
                                                <%}%>
                                              <%}%>
                                        </div>
                                    </div>
                                    <br />
                                    <div class="row text-center">
                                      <ul class="list-group list-group-flush">
                                          <li class="list-group-item">
                                              <a href="#"> <i class="fa fa-calendar"></i>  Approved On :  <span class="badge badge-warning pull-center r-activity">24/02/2020</span></a>
                                          </li>
                                        </ul>
                                      </div>
                                      <div class="row text-center">
                                        <ul class="list-group list-group-flush">
                                          <li class="list-group-item">
                                              <a href="#"> <i class="fa fa-calendar"></i>  Applied On :  <span class="badge badge-info pull-center r-activity">24/02/2020</span></a>
                                          </li>
                                      </ul>
                                    </div>
                                </div>
                                <div class="row text-center">
                                    <div class="col-lg-3"></div>
                                    <div class="col-lg-6"><button type="button" class="btn btn-secondary"
                                            data-toggle="modal" data-target="#myModal" onclick="viewRejectionClickHandler()">View rejection</button></div>
                                    <div class="col-lg-3"></div>
                                </div>
                                <div id="myModal" class="modal fade" role="dialog">
                                    <div class="modal-dialog">
                                        <!-- Modal content-->
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close"
                                                    data-dismiss="modal">&times;</button>
                                                <h4 class="modal-title">Reason for rejection</h4>
                                            </div>
                                            <div class="modal-body">
                                                <p>Insufficient attendance</p>
                                                <br />
                                                <p>- HOD</p>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default"
                                                    data-dismiss="modal">Close</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                      <div style="height: 30px"></div>
                            </div>
                        </div>
                        <%}%>
                    </div>
                </div>
            </div>
        </div>
    </div>
<% } %>

<!-- /Widgets -->
<!--  Traffic  -->

</div>

<script>
    function remindClickHandler() {
        console.log("remind Clicked!")
        // this formID should send a reminder to its next approver. Priority 1
    }
    function withdrawClickHandler() {
        console.log("withdraw Clicked!")
        // delete this formID from all tables. Priority 3
    }
    function downloadFormClickHandler() {
        console.log("download form clicked!")
        // download this formID with its blanks filled in. Priority 4
    }
    function viewRejectionClickHandler() {
        console.log("View Rejection CLicked!")
        // View rejection string of this formID and also get who wrote this rejection. Priority 2
    }
</script>

<%include partials/footer%>
